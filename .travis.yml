# You must sign into travis-ci.org and set the commit hook on your project for travis to
# run on your project. The secure: variable must be generated by running `travis encrypt`
# on a github oauth key that you can generate using curl.

sudo: false
language: node_js
node_js:
    - '0.12'
notifications:
  email:
    - ilya@pukhalski.com
env:
    global:
        # GH_OAUTH_TOKEN is the oauth token generated as described at
        # https://help.github.com/articles/creating-an-oauth-token-for-command-line-use
        #
        # curl -u 'username' -d '{"scopes":["repo"],"note":"push to gh-pages from travis"}' https://api.github.com/authorizations
        #
        # It must be encrypted using the travis gem
        # http://about.travis-ci.org/docs/user/build-configuration/#Secure-environment-variables
        #
        # travis encrypt GH_OAUTH_TOKEN=XXXXXXXXXXXXXXX
        #
        # User specific env variables
        - GH_OAUTH_TOKEN:
            - secure: 'mJ0gi2Z+XZqOZ2BdwxDOP/hyJmpCDNi+/5OBejzbnMoF7gmI29Jki9mmiNMAzsLSttWMKLxgM4boX0Be1kXWnZ/qXYDpPUpRh0BYZSRCA4Qzj2w6B9AzJvfsuyrRUVjo0Vi3ca0JWcAeYMNDV8SGaKFNsPnp6XxlPKPt5zRpB8AzytnZaXnmOvlzTA+tWI5umQsxDTghkbH1pbCRZfKvbpRdmbO8FVoKPSgF3sciFY8WaQYyDhgWZ22+Z5hBiNIuzCXgzY/JVuoHK5aYtd6xAg/Pwv2PV7e/MGGeW3yBtoae/MIshT8P3tp6O+PE4oRKky6J/us8Kg54trOKfnI3goZXiiHi3cwQSM15eIIeRrTsPB42lLUdYZlj2lrTkHtt48d9bbpIqA6O+tdBPaKp6qbn/JtGX+mOZWmYzg23ki/qYLaTfl4Bn8qRdb7fDJCZabcdzvJ7Tq5ZtJ1dAHMJY13GddD/O/CMZG/i60mMzIL41VbjDyd4qLmmqhrSGhAH4U+FKX4M9K2Q3K0miIlVUwf599xoAcmuufX63kBYwXcm6dXKbua3QYuSzPMIXlKyHmKJGiVjZcFjSsVyv/ioiNQSU55wPyI3BiBnAJjOn7pldkOtuVEJHZenViFA8T7Z7yDUH9EwoAh9ChfXWsX+Tri8Q5nagt8IY6MvTBixA4k='
        - GH_OWNER: todoflux
        - GH_PROJECT_NAME: todoflux
        - CHROME_PATH: '/home/travis/build/todoflux/todoflux/chrome-linux/chrome'
before_install:
    - export DISPLAY=:99.0
    - sh -e /etc/init.d/xvfb start
    - curl -Lo chrome.zip https://download-chromium.appspot.com/dl/Linux_x64 && unzip chrome.zip
    - curl -Lo chromedriver.zip http://chromedriver.storage.googleapis.com/2.16/chromedriver_linux64.zip && unzip chromedriver.zip
before_script:
    # install dependencies
    - npm install -g gulp
    - python -m SimpleHTTPServer > /dev/null 2>&1 &
    - sleep 2
script:
    # We want to gate on passing tests and a successful build
    - gulp
    - ./test-runner.sh
